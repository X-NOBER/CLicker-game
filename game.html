<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ultimate Cookie Clicker</title>
<style>
  html, body { margin:0; padding:0; overflow:hidden; background:#111; color:#fff; font-family:sans-serif;}
  canvas { display:block; margin:0 auto; }
  #ui { position:absolute; top:10px; left:10px; color:white; font-family:sans-serif; }
  button { margin:5px; padding:5px 10px; font-size:14px; }
</style>
</head>
<body>

<div id="ui"></div>

<script src="https://cdn.jsdelivr.net/npm/p5@1.6.0/lib/p5.min.js"></script>
<script>

let cookies = 0;
let cookiesPerClick = 1;
let cookiesPerSecond = 0;
let stageIndex = 0;
let auraPulse = 0;
let evolveAnim = 0;
let particles = [];

const stages = [
  {name:"Basic", threshold:0, auraColor: [214,167,110,80], img:null, dataUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAvElEQVR4nO3aUQqDMAwF0Mf//4mDbVui4E8Ej8kyXzDnlOqlH1wl0QAAAAAAAAAAAADAu2wfJweN6zUPFPh4/vFu3EtGqccql1zTj6qgx8Zb7uvnpl0TqX6M6KclPL7h2e0v4i4lT1Xlf3FfKs5X3QPKnDHDt29ycqTkzVv5cxS3MUrjz1D9TxhHtmHu1xZVu3S8wYyhnxNl6bnOPoWb4BGPYr+4z/jc8y5c5N58PDm7e2koy4Pq+6YHGLMx4ZynpcR4+ohr13bbWcRZsEZZ7dEJPMT/Y5wfy3lmnwAAAAAAAAAAAAAAAP4Crv8CzCMzkAKyZX4AAAAASUVORK5CYII="},
  {name:"Golden", threshold:1000, auraColor: [255,242,142,90], img:null, dataUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABM0lEQVR4nO3YwQ3CMAwF0Pz/n8kzW9AVC8UJrKOzZPQxPcuDYm0GAAAAAAAAAAAAAABwvtV/JF6axtuVDpYbS0Qir1f3Ueu0cmqpZfVU+TjXlc6ypzn2Tpb9RUdXXVz9zHeoFo+hJdbXJc1IfLNjsu3Xb7cGOr8TluY8j5b+yyfdTkXzbZfxfy3muG+E+2zL6oTn3D5GzwAAAAAAAAAAAAAAAL6FF4GmPj+HW5AAAAAASUVORK5CYII="},
  {name:"Diamond", threshold:100000, auraColor: [168,230,255,100], img:null, dataUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAvElEQVR4nO3aUQqDMAwF0Pz/n8kzW9AVC8UJrKOzZPQxPcuDYm0GAAAAAAAAAAAAAABwvtV/JF6axtuVDpYbS0Qir1f3Ueu0cmqpZfVU+TjXlc6ypzn2Tpb9RUdXXVz9zHeoFo+hJdbXJc1IfLNjsu3Xb7cGOr8TluY8j5b+yyfdTkXzbZfxfy3muG+E+2zL6oTn3D5GzwAAAAAAAAAAAAAAAL6FF4GmPj+HW5AAAAAASUVORK5CYII="},
  {name:"Cosmic", threshold:10000000, auraColor: [200,150,255,100], img:null, dataUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABY0lEQVR4nO3aS07DMBBF0ZP8/zdtE9RSXFuARXIdSuNMGRMNG6oAAAAAAAAAAAAAAAD8edty2+6cnKOvDQhijN3eN5Uas2nKsbU5SmzX8hNV8taUy/Xl+uF1+vPO6v1HbCeUqytbmWe5m6c6J2dVJ/Nh+z82b0s3zLb8o3RTPbt7z0Or4nyDzb8z7lA+Zo+FZ+rzp0+jpeXubH96zpq6stNfbT6E4N7KmfKyb9ljt4p6nM1vRkn7ev7Gu7RnrLE6b6VhfWwz8whhmuVeE0aa6F9vbdszffG4N8wz3JknYV7aazx3ArX3PntpR2cwAAAAAAAAAAAAAAAO5ZHn+ObhRJ2I7CNQAAAABJRU5ErkJggg=="},
  {name:"God", threshold:1000000000, auraColor: [255,248,201,120], img:null, dataUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABUElEQVR4nO3aQQrDMAwF0Of9/5nsFGqChyJcNyc3W1DZo03GpQAAAAAAAAAAAAAAAPBt7Xbzp9yJqM3xKHaMIpXbtq9P8n4bR7tnN3U9xR+7qlR52bPjNqzrd6S8O+sn5Tt7Hc0I2p8lT7q5+P3yTqxX+VreafNe0J1zlnF6fl87XW2LXn94r+6h2p7rY7m93HKXlM+N5nxr3lH4Kju2afEsr7nB3TVmyr9XWc3brDydK4oXHNjPAAAAAAAAAAAAAAAPA5F6A1TgLtxDb4mwAAAABJRU5ErkJggg=="}
];

const buildings = [
  {name:"Cursor", baseCost:15, cps:0.1, amount:0},
  {name:"Grandma", baseCost:100, cps:1, amount:0},
  {name:"Farm", baseCost:1100, cps:8, amount:0},
  {name:"Mine", baseCost:12000, cps:47, amount:0}
];

function preload(){
  for(let s of stages) s.img = loadImage(s.dataUrl);
}

function setup(){
  createCanvas(windowWidth, windowHeight);
  textAlign(CENTER, CENTER);
  imageMode(CENTER);
  setInterval(() => {
    let totalCPS = cookiesPerSecond;
    for(let b of buildings) totalCPS += b.cps*b.amount;
    cookies += totalCPS;
  }, 1000);
  createUI();
}

function draw(){
  background(20);

  // Aura
  auraPulse += 0.05;
  let aura = stages[stageIndex].auraColor;
  let pulse = sin(auraPulse)*20 + 60;
  for(let i=3;i>0;i--){
    fill(aura[0],aura[1],aura[2],aura[3]*(i/3));
    ellipse(width/2, height/2, 250 + pulse*i, 250 + pulse*i);
  }

  // Evolution check
  for(let i=stages.length-1;i>=0;i--){
    if(cookies >= stages[i].threshold){
      if(stageIndex!==i) evolveAnim = 1;
      stageIndex=i;
      break;
    }
  }

  // Evolution animation
  if(evolveAnim>0) evolveAnim-=0.05;
  let scaleLerp = map(evolveAnim,0,1,1,1.3);

  // Cookie draw
  push();
  translate(width/2, height/2);
  let pulseSize = 1 + sin(frameCount*0.05)*0.02;
  image(stages[stageIndex].img, 0,0,200*pulseSize*scaleLerp,200*pulseSize*scaleLerp);
  pop();

  // Particle trails
  for(let p of particles){
    p.update();
    p.show();
  }
  particles = particles.filter(p => !p.finished());

  // Text
  fill(255);
  textSize(28);
  text(`Cookies: ${floor(cookies)}`, width/2, height-100);
  textSize(18);
  text(`Stage: ${stages[stageIndex].name}`, width/2, height-60);
  text(`CPS: ${getCPS().toFixed(1)}`, width/2, height-40);
  text(`CPC: ${cookiesPerClick}`, width/2, height-20);
}

function mousePressed(){
  if(dist(mouseX, mouseY, width/2, height/2) < 100){
    cookies += cookiesPerClick;
    evolveAnim = 0.5;
    spawnParticles();
  }
}

// Particle system
function spawnParticles(){
  let aura = stages[stageIndex].auraColor;
  for(let i=0;i<10;i++){
    particles.push(new Particle(width/2, height/2, aura));
  }
}

class Particle{
  constructor(x,y,colorArr){
    this.pos = createVector(x,y);
    let angle = random(TWO_PI);
    let speed = random(1,3);
    this.vel = createVector(cos(angle)*speed, sin(angle)*speed);
    this.alpha = 255;
    this.colorArr = colorArr;
  }
  update(){
    this.pos.add(this.vel);
    this.alpha -= 5;
  }
  finished(){ return this.alpha <=0; }
  show(){
    noStroke();
    fill(this.colorArr[0], this.colorArr[1], this.colorArr[2], this.alpha);
    ellipse(this.pos.x, this.pos.y, 8);
  }
}

// UI buttons
function createUI(){
  const ui = document.getElementById('ui');
  buildings.forEach((b,i)=>{
    const btn = document.createElement('button');
    btn.innerText = `${b.name} (${b.amount}) - ${b.baseCost} cookies`;
    btn.onclick = ()=>{
      if(cookies >= b.baseCost){
        cookies -= b.baseCost;
        b.amount++;
        b.baseCost = floor(b.baseCost*1.15);
        btn.innerText = `${b.name} (${b.amount}) - ${b.baseCost} cookies`;
      }
    };
    ui.appendChild(btn);
  });
  const cpcBtn = document.createElement('button');
  cpcBtn.innerText = `Upgrade Click (+1 CPC) - 50 cookies`;
  cpcBtn.onclick = ()=>{
    if(cookies >=50){
      cookies -=50;
      cookiesPerClick +=1;
    }
  };
  ui.appendChild(cpcBtn);
}

function getCPS(){
  let total = cookiesPerSecond;
  for(let b of buildings) total += b.cps*b.amount;
  return total;
}

</script>

</body>
</html>
